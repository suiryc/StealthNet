<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui">
<h:head>
  <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="pragma" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <!-- Simple hack to keep session alive for the login page, and prevent expired view issues. -->
  <meta http-equiv="refresh" content="#{session.maxInactiveInterval - 10}" />
  <h:outputStylesheet name="main.css" library="css" />
</h:head>
<h:body>
  <h:panelGroup rendered="#{param.reason == 'expired'}">
    <p:dialog id="dialog" widgetVar="dlg" modal="true" draggable="false" resizable="false" width="300" header="Session expired">
Your session has expired, please login again.<br/><br/>
      <center>
        <p:commandButton id="ok" value="Ok" onclick="dlg.hide();" type="button" />
      </center>
    </p:dialog>

    <script type="text/javascript">
function redirectLogin() {
    window.location.replace("#{request.contextPath}/login.jsf");
}

$(function() {
    dlg.cfg.behaviors = { close: redirectLogin };
    dlg.show();
});
    </script>
  </h:panelGroup>

  <center>
    <p:messages id="messages" showDetail="true" autoUpdate="true" />
    <h:form>
      <p:panel header="Login" style="width: 350px;">
        <h:panelGrid columns="2" cellpadding="2">
          <h:outputText value="UserName" />
          <p:inputText value="#{loginManager.username}" />

          <h:outputText value="Password" />
          <p:password value="#{loginManager.password}" />

          <h:panelGroup />
          <p:commandButton value="Login" action="#{loginManager.login}" ajax="false" />
        </h:panelGrid>
      </p:panel>
    </h:form>
  </center>
</h:body>
</html>
